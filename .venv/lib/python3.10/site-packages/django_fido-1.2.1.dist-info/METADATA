Metadata-Version: 2.1
Name: django-fido
Version: 1.2.1
Summary: Django application for FIDO protocol
Home-page: https://github.com/CZ-NIC/django-fido
Author: Vlastimil ZÃ­ma
Author-email: vlastimil.zima@nic.cz
Keywords: django,fido,u2f,fido2
Classifier: Development Status :: 4 - Beta
Classifier: License :: OSI Approved :: MIT License
Classifier: Framework :: Django
Classifier: Framework :: Django :: 3.0
Classifier: Framework :: Django :: 3.1
Classifier: Framework :: Django :: 3.2
Classifier: Framework :: Django :: 4.0
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Topic :: Internet :: WWW/HTTP
Classifier: Topic :: Security :: Cryptography
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: ~=3.7
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: Django (>=3.0)
Requires-Dist: fido2 (~=1.1.0)
Requires-Dist: django-app-settings (>=0.7.1)
Requires-Dist: jwcrypto
Requires-Dist: requests
Requires-Dist: cryptography
Requires-Dist: pyopenssl
Provides-Extra: quality
Requires-Dist: isort ; extra == 'quality'
Requires-Dist: flake8 ; extra == 'quality'
Requires-Dist: pydocstyle ; extra == 'quality'
Requires-Dist: mypy ; extra == 'quality'
Requires-Dist: polint ; extra == 'quality'
Provides-Extra: test
Requires-Dist: mock ; extra == 'test'
Requires-Dist: responses ; extra == 'test'
Provides-Extra: types
Requires-Dist: types-requests ; extra == 'types'
Requires-Dist: types-mock ; extra == 'types'
Requires-Dist: types-pyOpenSSL ; extra == 'types'

# django-fido #

[![Python tests](https://github.com/CZ-NIC/django-fido/actions/workflows/python-test.yml/badge.svg)](https://github.com/CZ-NIC/django-fido/actions/workflows/python-test.yml)
[![JS tests](https://github.com/CZ-NIC/django-fido/actions/workflows/js-test.yml/badge.svg)](https://github.com/CZ-NIC/django-fido/actions/workflows/js-test.yml)
[![codecov](https://codecov.io/gh/CZ-NIC/django-fido/branch/master/graph/badge.svg)](https://codecov.io/gh/CZ-NIC/django-fido)

> Django application for FIDO protocol

Django-fido provides basic components for FIDO 2 authentication - model to store user's FIDO 2 authenticator data and basic views.

## Table of Contents ##
- [Dependencies](#dependencies)
- [Configuration](#configuration)
- [Changes](#changes)
- [Testing](#testing)
- [License](#license)

## Dependencies ##
 * Python 3.5 and higher
 * Django >= 3.0

## Configuration ##

1. Add `django_fido` to `INSTALLED_APPS`.
2. Add `django_fido.backends.Fido2AuthenticationBackend` to `AUTHENTICATION_BACKENDS`.
3. Link django-fido URLs into your `urls.py`:

       urlpatterns += [
          url(r'', include('django_fido.urls')),
       ]

4. If you wish, set string variable `DJANGO_FIDO_RP_NAME`.

### Extra configuration ###
#### DJANGO_FIDO_RESIDENT_KEY ####
Default: False

Purpose: Set to True to enable discoverable credentials, private key and associated metadata is stored in persistent memory on the authenticator. This is useful for passwordless authentication.

## One step authentication

You can also decide to use one step authentication.
In this case, you will use just one authentication form, that will collect username, password and FIDO2 credentials.
In addition to the configuration above, you also need to:

1. Set `DJANGO_FIDO_TWO_STEP_AUTH` to `False`.
2. Replace `django_fido.backends.Fido2AuthenticationBackend` with
   `django_fido.backends.Fido2GeneralAuthenticationBackend` in `AUTHENTICATION_BACKENDS`.
3. Set `DJANGO_FIDO_AUTHENTICATION_BACKENDS` to the list of your additional authentication backends, if you use others
   than `django.contrib.auth.backends.ModelBackend`.
4. Set `data-autosubmit-off` attribute on the form element of your login page.

Please note that your login form must have a field named `username`, even if your `USERNAME_FIELD` is not `username`.

## Metadata download

If you want to be able to download authenticator metadata, you need to set `DJANGO_FIDO_METADATA_SERVICE` setting which is a dictionary.
The MDS is available in two versions v2 (deprecated) and v3 (current).
If you want to use MDSv2, you have to set a valid `ACCESS_TOKEN`.
If you want to use MDSv3, you have to set `MDS_FORMAT` to `3` and set a valid `URL` providing the MDSv3 data.
Then you can periodically run the `download_authenticator_metadata` management command.
If metadata are available for the given `Authenticator`, its `metadata` property will be an object.
The `level`, `vulnerabilities` and `is_update_available` methods on `metadata` can be used to determine the trust and certification level.

## Passwordless

This authentication requires "discoverable credential" and using that credential to perform a user lookup using the passwordless authentication backend

1. Set `DJANGO_FIDO_RESIDENT_KEY` to `True`
2. Set 'DJANGO_FIDO_PASSWORDLESS_AUTH' to 'True'
3. Set 'DJANGO_FIDO_TWO_STEP_AUTH' to 'False'
3. Replace `django_fido.backends.Fido2AuthenticationBackend` with
   `django_fido.backends.Fido2PasswordlessAuthenticationBackend` in `AUTHENTICATION_BACKENDS`.

# Set user verification requirement

Set `DJANGO_FIDO_USER_VERIFICATION` to `required`,  `preferred` or `discouraged`, default is `None`

## Changes ##
See [changelog](https://github.com/CZ-NIC/django-fido/blob/master/CHANGELOG.md).

## Testing ##
Use `tox` to run tests

    tox

## License ##

See [LICENSE](https://github.com/CZ-NIC/django-fido/blob/master/LICENSE).

# Changelog #
## 1.2.1
 * Fixed metadata lookup for devices with device certificate directly in MDS

## 1.2.0
 * Changed redirect after adding authenticator in administration to changelist instead of change view
 * Made `user_handle` in admin readonly
 * Upgrade to nodejs 18.x
 * Fixed resident key registration

## 1.1.0
 * Add support for fido2 1.1
 * Drop support for fido2 < 1.1
 * Export js translations for optional modifications

## 1.0.1
 * Pin fido2 dependency

## 1.0.0
 * Add support for fido2 1.0
 * Drop support for fido2 < 1.0
 * Provide fido2 JS functions without side effects

## 0.43
 * Handle InvalidStateError
 * Drop `FIDO_CERTIFIED` from `AUTH_LEVELS`

## 0.42
 * Export createTranslations function in fido2.js

## 0.41
 * Fix reversing of the order of statusReports in metadata

## 0.40
 * Pin fido2 to ~= 0.9
 * Drop support for Django 2.x
 * Fix package build with setuptools-npm

## 0.39
 * Fix uncaught exception when user does not exist

## 0.38
 * Fix Authenticator.metadata if no identifier is present
 * Added passwordless auth backend

## 0.37
 * Drop support for Django 1.11
 * Drop support for python 3.5
 * Sets a default_auto_field
 * Fix django.conf.urls deprecation warnings
 * Added user_handle field to Authenticator model
 * Added DJANGO_FIDO_RESIDENT_KEY (default False) app setting
 * Restructured js handling key registration and exposed additional functions

## 0.36
 * Sort users in admin Authenticator add form by username
 * Sort statusReport dictionary in metadata

## 0.35
 * Change authenticate request arg to positional
 * Fix metadata for empty credential_data
 * Bump path-parse from 1.0.6 to 1.0.7
 * Proper cleanup of database model under MDS3

## 0.34 ##
 * Fix MDS3 metadata verification

## 0.33 ##
 * Support for MDSv3 AuthenticatorMetadata

## 0.32 ##
 * Fix authentication for devices without counter support

## 0.31 ##
 * Support for `fido2` library  `>0.9.0`
 * Add tests under django 3.1
 * Handle when multiple device metadata are returned
 * JS fixes and updates

## 0.30 ##
 * Counter is now stored as BigInteger.
 * Restrict version of `fido2` library to `<0.9.0`.

## 0.29 ##
 * Catch `InvalidAttestation` error in registration view.

## 0.28 ##
 * Updated error strings to be more informative.

## 0.27 ##
 * Throw form error on unknown attestation format instead of a server error.

## 0.26 ##
 * Improve metadata matching for U2F authenticators.

## 0.25 ##
 * **BREAKING** - AuthenticatorMetadata are now looked up by URL and not by an identifier. If you are downloading metadata, you need to clear them all and re-download to prevent multiple objects for each authenticator.
 * Update JS dependencies

## 0.24 ##
 * Metadata validation

## 0.23 ##
 * Display no authenticator error
 * `error` key in repsponse of `BaseFido2RequestView` is now deprecated and will be removed in the future
 * Added metadata download and reporting

## 0.22 ##
 * Use username as a backup `displayName`

## 0.21 ##
 * Create FIDO errors list when needed unless it already exists
 * Clear FIDO errors list before each registration or authentication request

## 0.20 ##
 * Fix Django 3.0 compatibility issues in templates

## 0.19 ##
 * Added class attribute `attestation_types` to `Fido2ViewMixin` to specify allowed attestation types during registration.
 * Set default value of setting `DJANGO_FIDO_AUTHENTICATION_BACKENDS` to list containing `django.contrib.auth.backends.ModelBackend`

## 0.18 ##
 * Fix issue caused by default value of `DJANGO_FIDO_AUTHENTICATION_BACKENDS`. It is now empty list.

## 0.17 ##
 * **BREAKING** Replace `Fido2ModelAuthenticationBackend` with more general `Fido2GeneralAuthenticationBackend`.

## 0.16 ##
 * **BREAKING** Authenticator `label` has to be unique for user. This can potentialy break if you have multiple tokens for user.
 * Add authenticator admin.
 * Add one step authentication.

## 0.15 ##
 * Add ``DJANGO_FIDO_RP_NAME`` setting.
 * Add back autosubmit on login view.
 * Display error in login view on server request error.

## 0.14 ##
 * Add label to Authenticator model.
 * Remove autosubmit on registration view.
 * Update JS dependencies.

## 0.13 ##
 * Support fido2 0.6-0.8.
 * Add support for python 3.8.
 * Fixup annotations.

## 0.12 ##
 * Fix dependencies (add webpack-cli).

## 0.11 ##
 * Fix webpack output path.

## 0.10 ##
 * Fix dependencies (add webpack).

## 0.9 ##
 * Refactor JS code.
 * Update setup.
 * Add bumpversion.

## 0.8 ##
 * Fix JS translation lazynes.
 * For empty values, submit button reload page.

## 0.7 ##
 * Add credential ID field.
 * Drop `credential_data` field.
 * Update error messages.
 * Mark django-fido as typed.
 * Add JS hooks.

## 0.6 ##
 * Use FIDO 2 instead of U2F.
 * Drop python 2.7.
 * Add annotations and mypy check.
 * Move repository to a CZ.NIC account.

## 0.5 ##
 * Fix JS translation lazynes

## 0.4 ##
 * Update JS messages.
 * Drop unused `polint` environment in tox.

## 0.3 ##
 * Store attestation certificate in database #6
 * Install package data #7

## 0.2 ##
 * Accept any arguments in `BaseU2fRequestView.get`
 * Add czech translations
 * Fix links in README

## 0.1 ##
 * Initial version
